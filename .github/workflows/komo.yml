name: Monitor Sensitive Artifacts

on:
  push:
    branches:
      - "**"

jobs:
  scan:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Scan for sensitive files
        run: |
          echo "Scanning repository..."

          FOUND=0

          if find . -type f -name "sk.bin" | grep -q .; then
            echo "❌ Found sk.bin"
            FOUND=1
          fi

          if find . -type f -name "*.bin" | grep -q .; then
            echo "❌ Found *.bin"
            FOUND=1
          fi

          if find . -type d -name "bounty3_data" | grep -q .; then
            echo "❌ Found bounty3_data directory"
            FOUND=1
          fi

          if [ "$FOUND" -eq 1 ]; then
            echo "::error ::Sensitive artifact detected in repository"
            exit 1
          fi

          echo "No sensitive artifacts found."
